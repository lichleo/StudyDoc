# 科学运算库

## sympy

sympy是一个Python的科学计算库，用一套强大的符号计算体系完成诸如多项式求值、求极限、解方程、求积分、微分方程、级数展开、矩阵运算等等计算问题。

### 声明符号变量
在SymPy中要明确声明符号变量。声明后可以使用符号表达式。
```python
from sympy import *  
# 符号变量  
a = symbols('a')  
x, y, z = symbols('x y z')  
ex = x**2+x+1  
print(ex)  
```
输出：
> x**2 + x + 1

###	表达式的运算
在sympy中，有理数类用两个整数来表示一个有理数的分子与分母。Rational(1,3)代表1/3。
开方运算等如果结果是无理数不会转为近似的浮点数。
有一些特殊的常数，像e和pi，它们会被当作符号去对待。（1+pi不会求得值，反而它会保持为1+pi）。无穷用oo来表示。
通过evalf()函数将得到表达式的数值计算。
```python
ex = Rational(1,3) +sqrt(8) + 2*pi  
print(ex)  
print(ex.evalf())  
```

输出：
> 1/3 + 2*sqrt(2) + 2*pi
> 9.44494576525911


对于符号表达式的运算，通过subs替换符号变量。
```python
expr = x**2+3*y  
result = expr.evalf(subs={x: 2,y: 5})
```

可以通过pprint()替换print()来更好的显示公式。
```python
f1 = Rational(1,3) +sqrt(8) + 2*pi  
f2 = (x+2)/(x+1)  
print(f1)  
print(f2)  
  
pprint(f1)  
pprint(f2)
```

返回结果：
> Basic print
> 1/3 + 2*sqrt(2) + 2*pi
> (x + 2)/(x + 1)
> Pretty print
> 1/3 + 2⋅√2 + 2⋅π
> x + 2
> ─────
> x + 1

使用latex()函数会输出Latex格式(论文排版格式)的结果。word2019支持word公式和Latex公式的转换。
```python
from sympy import *  
  
#定义变量  
a,b,c = symbols('a b c')  
  
expr = sqrt(a/b)  
print(latex(expr)) 
```

返回结果：
> \sqrt{\frac{a}{b}}

###	符号变量的代换
通过subs函数，可以将符号变量代换为常量或符号变量。

- 数值替换，用数值替换符号，进行带入计算。
-	符号替换，用一些符号替换符号。

当需要替换多个表达式时，可以在subs()里使用列表或字典。
如：subs([(x,2), (y, 3), (z, 4)])或subs({x:2, y:3, z:4})表示：将x替换成2，y替换成3，z替换成4
```python
ex = x**2+x+1    
print(ex.subs(x,5))  
print(ex.subs(x,y+2))  
print((x*y).subs({x:pi, y:2*a}))  
```

返回结果：
> 31
> y + (y + 2)**2 + 3
> 2*pi*a

###	多项式函数

常用的多项式函数如下：
函数|	描述
---|---
simplify()|	化简
expand()|	多项式展开，非多项式类型的加trig=True参数
factor()|	因式分解或表达式折叠
apart()|	分数公式的分离，如(x+2)/(x+1) 1 + 1/(x + 1)
together()|	分数公式的合并，如(1/x+1/y) (x + y)/(x*y)

调用函数既可以使用simplify(expr)的形式，也可以使用expr. simplify()的形式。


###	解方程
通过solve()可以接方程或方程组，或者得到变量的关系式。
```python
from sympy import *  
  
x, y = symbols('x y')  
  
# 解方程，单变量可省略第二个参数  
print(solve( sin(x)+cos(x)-1 ))  
print(solve(x**2-y**2, x))  
  
# 解方程组  
f1 = x+y-3  
f2 = x-y+5  
result = solve([f1,f2],[x,y])  
print(result)  
```

返回结果：
> [0, pi/2]
> [-y, y]
> {x: -1, y: 4}

###	求和
通过summation(f,(k,1,n))求和。
∑_(k=1)^n▒〖f(k)〗
求1到10的平方和。
```python
import sympy  
  
#定义变量  
k=sympy.Symbol('k')  
  
f = k**2  
#前面参数放函数，后面放变量的变化范围  
s=sympy.summation(f,(k,1,10))  
```

###	函数求导
使用diff()方法，求df/dx。
函数diff(func, x, n) 是函数func对x求n阶导数。
偏导数是多变量函数对单变量求导，同样使用diff()函数。
```python
from sympy import *  
  
#定义变量  
x, y = symbols('x y')  
  
f1 = acos(x)  
f2 = sin(2*x*y)  
  
s1 = diff(f1,x)     #f(x)对dx求微分   
s2 = diff(f2,x)     #f(x,y)对dx求偏微分   
s3 = diff(f2,x,2)   #f(x,y)对dx求二阶微分   
s4 = diff(f2,x,y)   #f(x,y)对dxdy求微分  
  
for k in range(1,5):  
    exec('print(s'+str(k)+')')  
```


返回结果：
> -1/sqrt(1 - x**2)
> 2*y*cos(2*x*y)
> -4*y**2*sin(2*x*y)
> 2*(-2*x*y*sin(2*x*y) + cos(2*x*y))

###	积分
求积分有三种形式，并且都用的是integrate()方法
-	求不定积分：integrate(expr, var)
-	求定积分：   integrate(expr, (var, min, max))
-	求多重积分：integrate(expr, (var1, min, max),(var2,min,max))

**例子** 求∫_0^π▒〖sin⁡(x)dx〗和∬▒(sinx+cosy)dxdy

```python
from sympy import *  
  
#定义变量  
x, y = symbols('x y')  
  
print(integrate(sin(x),(x,0,pi/2)))  
  
expr = sin(x)+cos(y)  
s = integrate(expr,x,y)  
print(s)  
```

返回结果：
> 1
> x*sin(y) - y*cos(x)

###	求极限
使用limit(fx,x,k)求fx在x趋于k的极限：lim┬(x→k)⁡fx
lim┬(n→∞)⁡〖(1+1/n)^n 〗=e

```python
fx = (1+1/x)**x  
print(limit(fx,x,oo))  
```

返回自然对数的底e，在sympy中是sympy.E。

###	泰勒级数展开
series是泰勒展开函数，pprint将公式用更好看的格式打印出来。
将sin函数展开到10阶。

```python
x = symbols('x')  
tmp = series(sin(x), x, 0, 10)  

pprint(tmp) 
```



